<!doctype html>
<!--
Awesome stuff

press 'esc' for overview
press 's' for speaker view window
press 'b' to blank the screen
press space bar to move to next slide

-->

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Spring NEARC 2015 Database Workshop</title>

    <meta name="description" content="Filter, Aggregate, and Combine: Taking Advantage of SQL Queries for Enterprise Databases">
    <meta name="author" content="Guido Stein">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/league.css" id="theme">

    <!-- Code syntax highlighting -->
    <!--    <link rel="stylesheet" href="lib/css/zenburn.css"> -->
    <link rel="stylesheet" href="lib/css/railscasts.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
    <!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->

</head>

<body>

    <div class="reveal">

        <!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">
            <section>
                <h1>DRAFT</h1>
                <img src="https://s3.amazonaws.com/geospatialdomination/presentations/20150511nearc/appgeo-logo.jpg" />
            </section>

            <section id='title'>
                <h1>Filter, Aggregate, and Combine</h1>
                <p>Taking Advantage of SQL Queries for Enterprise Databases</p>
                <img src="https://s3.amazonaws.com/geospatialdomination/presentations/20150511nearc/appgeo-logo.jpg" />
                <p>
                    <small><a href="http://www.appgeo.com">Guido Stein - Applied Geographics, Inc.</a> / <a href="http://twitter.com/guidos">@guidos</a></small>
                </p>
                <!--
                <p>
                    <small><a href="https://s3.amazonaws.com/guidos-public/presentations/Spring+NEARC+2015+Database+Workshop.pdf">pdf version</a></small>
                </p>
-->
            </section>

            <section id='welcome'>
                <h1>Welcome</h1>
                <p>
                    Guido Like
                    <span class="fragment grow">Burrito
                    </span>
                </p>
            </section>

            <section id='format'>
                <div style="float:left">
                    <h2>File
                        <br/>(Esri Native Formats)</h2>
                    <ul>
                        <li>Shape File</li>
                        <li>File Geodatabase</li>
                    </ul>
                </div>
                <div>
                    <h2>Enterprise
                        <br />(SDE Connection)</h2>
                    <ul>
                        <li>IBM DB2</li>
                        <li>Informix</li>
                        <li>Oracle</li>
                        <li class="fragment highlight-red" data-fragment-index="1">PostgreSQL</li>
                        <li class="fragment highlight-red" data-fragment-index="1">Microsoft SQL Server</li>
                    </ul>
                </div>
            </section>

            <section id='enterprise-advantage'>
                <h2>Enterprise
                    <span class="fragment highlight-red" data-fragment-index="1">
                        <span class="fragment roll-in" data-fragment-index="1">G</span>
                    </span>DB
                </h2>
                <ul>
                    <li>Server Based</li>
                    <ul>
                        <li>Accessible from more than one place</li>
                        <li>Multi-User</li>
                    </ul>
                    <li>SQL Data Processing</li>
                    <span class="fragment highlight-red" data-fragment-index="1">
                        <li class="fragment roll-in" data-fragment-index="1">SQL Geospatial Data Processing</li>
                    </span>
                </ul>
            </section>

            <section id='enterprise-overview'>
                <ul>
                    <li style='list-style-type:none'>Esri Enterprise Database Overview</li>
                    <li style='list-style-type:none'>&nbsp;</li>
                    <li style='list-style-type:none'>Attributes and Geometry stored in same table</li>
                    <li style='list-style-type:none'>&nbsp;</li>
                    <ul>
                        <li>PostgreSQL</li>
                        <ul>
                            <li>ST_Geometry</li>
                            <li>PostGIS geometries</li>
                        </ul>
                        <li style='list-style-type:none'>&nbsp;</li>
                        <li>Microsoft SQL Server</li>
                        <ul>
                            <li>Microsoft spatial types
                                <br/>(geometry and geography)</li>
                        </ul>
                    </ul>
                    <li style='list-style-type:none'>&nbsp;</li>
                    <li style='list-style-type:none'><a href="http://desktop.arcgis.com/en/desktop/latest/manage-data/gdb-architecture/geodatabase-storage-in-relational-databases.htm">More Esri Overview</a></li>
                </ul>
            </section>
            <section id='create-database-view'>
                <p style="text-align:left;">Create Database View Tool</p>
                <table>
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Explanation</th>
                            <th>Data Type</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>input_database</td>
                            <td>The database that contains the tables or feature classes used to construct the view. This database is also where the view will be created.</td>
                            <td>Workspace</td>
                        </tr>
                        <tr>
                            <td>view_name</td>
                            <td>The name of the view that will be created in the database.</td>
                            <td>String</td>
                        </tr>
                        <tr>
                            <td>view_definition</td>
                            <td>An SQL statement used to construct the view. String
                            </td>
                            <td>String</td>
                        </tr>
                    </tbody>
                </table>



            </section>

            <section id='setup-account'>
                <h2>Setup CartoDB Account</h2>
                <h2><a href='http://cartodb.com'>http://cartodb.com</a></h2>
            </section>

            <section id='ogc-geometry'>
                <h2>Enterprise Table</h2>
                <table>
                    <thead>
                        <tr>
                            <th>OGC_GEOMETRY</th>
                            <th>DESCRIPTION</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>POINT (30 10)</td>
                            <td>(X Y)</td>
                        </tr>
                        <tr>
                            <td>MULTILINESTRING(
                                <br />&nbsp;&nbsp;&nbsp;&nbsp;(10 10, 20 20, 10 40),
                                <br />&nbsp;&nbsp;&nbsp;&nbsp;(40 40, 30 30, 40 20, 30 10)
                                <br />)
                            </td>
                            <td>(
                                <br />(X Y, X Y),
                                <br />(X Y, X Y)
                                <br />)</td>
                        </tr>
                        <tr>
                            <td>MULTIPOLYGON (
                                <br />&nbsp;&nbsp;&nbsp;&nbsp;((30 20, 45 40, 10 40, 30 20)),
                                <br />&nbsp;&nbsp;&nbsp;&nbsp;((15 5, 40 10, 10 20, 5 10, 15 5))
                                <br />)</td>
                            <td>(
                                <br />((X Y, X Y),(X Y, X Y)),
                                <br />((X Y, X Y))
                                <br />)</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section>
                <h2>Other Resources</h2>
                <ul style="list-style-type: none;">
                    <li>esri
                        <ul style="list-style-type: none;">
                            <li><a href="http://desktop.arcgis.com/en/desktop/latest/tools/data-management-toolbox/create-database-view.htm">Create Database View</a></li>
                            <li><a href="http://desktop.arcgis.com/en/desktop/latest/manage-data/databases/dbms-data-types-supported.htm">DBMS data types supported in ArcGIS</a></li>

                        </ul>
                    </li>
                    <li>CartoDB
                        <ul style="list-style-type: none;">
                            <li><a href="http://docs.cartodb.com/tips-and-tricks.html">Tips and Tricks</a></li>

                        </ul>
                    </li>
                    <li>Microsoft
                        <ul style="list-style-type: none;">
                            <li><a href="https://msdn.microsoft.com/en-us/library/bb933960.aspx">OGC Methods on Geometry Instances</a></li>
                        </ul>
                    </li>
                    <li>Discover Spatial
                        <ul style="list-style-type: none;">
                            <li><a href="http://discoverspatial.com">Turbocharge your geospatial education</a></li>
                        </ul>
                    </li>
                    <li>Boundless
                        <ul style="list-style-type: none;">
                            <li><a href="http://workshops.boundlessgeo.com/postgis-intro/spatial_relationships.html">Introduction to PostGIS: Spatial Relationships</a></li>
                        </ul>
                </ul>
            </section>

            <section data-background="https://s3.amazonaws.com/hakim-static/reveal-js/image-placeholder.png">
            </section>

            <section data-background="#dddddd">
                <pre>
                    <code class='sql'>SELECT * FROM my_table WHERE id = '5'</code>
                </pre>
            </section>

        </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
        // Full list of configuration options available at:
        // https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize({
            controls: true,
            progress: true,
            history: true,
            center: true,

            transition: 'convex', // none/fade/slide/convex/concave/zoom

            // Optional reveal.js plugins
            dependencies: [{
                src: 'lib/js/classList.js',
                condition: function() {
                    return !document.body.classList;
                }
            }, {
                src: 'plugin/markdown/marked.js',
                condition: function() {
                    return !!document.querySelector('[data-markdown]');
                }
            }, {
                src: 'plugin/markdown/markdown.js',
                condition: function() {
                    return !!document.querySelector('[data-markdown]');
                }
            }, {
                src: 'plugin/highlight/highlight.js',
                async: true,
                condition: function() {
                    return !!document.querySelector('pre code');
                },
                callback: function() {
                    hljs.initHighlightingOnLoad();
                }

            }, {
                src: 'plugin/zoom-js/zoom.js',
                async: true
            }, {
                src: 'plugin/notes/notes.js',
                async: true
            }]
        });
    </script>

</body>

</html>
<!-- other styling

            <section data-background="#dddddd">
            </section>


-->


<!-- import from google docs

Filter, Aggregate, and Combine: Taking Advantage of SQL Queries for Enterprise Databases

If you are interested in getting comfortable writing queries with SQL and SQL spatial data types to take advantage of your enterprise data, then this is a great place to start. This session will introduce you to the SQL skills you need to write PostgreGIS spatial queries. This will be a hands on tutorial using real data in a CartoDB test environment. Using these SQL skills you will be able to generate useful SDE views with a Geodatabase stored in PostgreSQL DBMS.



Enterprise Database overview
Types
Spatial Types (OGC, WKT, ST)
Spatial Databases (PostGIS, MSSQL, SpatiaLite)
ESRI SDE
CartoDB & PostGIS

Setup Working environment
CartoDB create account
Import data

Case Study 1
select
where
order by
group by

Case Study 2
left outer join
sub joins

Case Study 3
geom
wkt
srid

Case Study 3
spatial joins

Case Study 4
spatial queries, aggregations, and sub queries… oh my
DATA

Boston Rodent Data(CSV)
https://data.cityofboston.gov/api/views/ynt4-n6g9/rows.csv?accessType=DOWNLOAD

Political Boundaries
http://wsgw.mass.gov/data/gispub/shape/state/townssurvey_shp.zip

Big Belly Trash Locations (needs lat/lon processesd
https://data.cityofboston.gov/api/views/42qi-w8d7/rows.csv?accessType=DOWNLOAD

ALTER TABLE big_belly_locations
ADD latitude double precision

ALTER TABLE big_belly_locations
ADD longitude double precision



UPDATE big_belly_locations
SET latitude = CAST ((regexp_matches(LOCATION, '[(](.*),(.*)[)]'))[1] AS double precision)

UPDATE big_belly_locations
SET longitude = CAST ((regexp_matches(LOCATION, '[(](.*),(.*)[)]'))[2] AS double precision)


Neighborhood Boundaries
https://data.cityofboston.gov/download/af56-j7tb/application/zip

CartoDB Tips and tricks
http://docs.cartodb.com/tips-and-tricks.html

-->
